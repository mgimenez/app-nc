!function(win,doc,$){"use strict";var events={getEvents:function(zone){return new Promise(function(resolve,reject){$.ajax({url:"https://api-nc.herokuapp.com/?zone="+zone,success:function(data){resolve(data)}})})}};window.events=events}(window,window.document,window.jQuery),function(win,doc,$,events,templates){"use strict";var app={init:function(){this.populateEvents(),this.zonesHandler()},populateEvents:function(z){var location=doc.location.search,zone=z||location.split("?zone=")[1],$nextEvents=$(".js-next-events").addClass("loading"),defaultZone="buenos-aires";events.getEvents(zone).then(function(events){$nextEvents.append(templates.listEvents(events)).removeClass("loading")}),void 0===z&&(zone=void 0===zone?defaultZone:zone,location=""===location?"?zone="+defaultZone:location,$('a[href="'+location||NaN).addClass("active"),win.history.pushState({zone:zone},"eRaver","/?zone="+zone))},getZones:function(zone,self){$(".js-list-zones a").removeClass("active"),$(self).addClass("active"),$(".js-next-events").empty(),app.populateEvents(zone)},zonesHandler:function(){$(".js-list-zones").on("click","a",function(ev){ev.preventDefault();var zone=ev.target.href.split("?zone=")[1];app.getZones(zone,this),win.history.pushState({zone:zone},"eRaver","/?zone="+zone)}),window.onpopstate=function(event){if(null!==event.state){var trigger=$('a[href="?zone='+event.state.zone+'"]');app.getZones(event.state.zone,trigger)}}}};app.init()}(window,window.document,window.jQuery,window.events,window.templates);